<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ClueNote</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#0f1b31; --panel2:#132545; --text:#e8f1ff;
      --muted:#90a4c3; --accent:#4ea0ff; --danger:#ff5c5c; --line:#1a2a4b;
      --ok:#32d475; --card:#8ed0ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--bg),#0a0f1a);
      color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      display:flex; flex-direction:column; align-items:center; gap:8px;
      padding:8px;
    }

    /* Max-Breite schmal f√ºr Handy, volle H√∂he (kein Scrollen) */
    .wrap{ width:min(520px,100%); height:100dvh; display:flex; flex-direction:column; gap:8px; }

    header {
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center; /* <- Mitte! */
  position:relative; /* damit wir Reset oder Shortcuts trotzdem positionieren k√∂nnen */
}
    h1{ margin:0; font-size:18px; letter-spacing:.2px }
    .hint{ color:var(--muted); font-size:11px }

    .toolbar{
      display:flex; gap:6px; flex-wrap:wrap; align-items:center;
      background:var(--panel); border:1px solid var(--line);
      border-radius:12px; padding:6px;
    }
    .tool{
      border:1px solid #27406f; background:var(--panel2); color:var(--text);
      padding:6px 9px; border-radius:8px; cursor:pointer; font-weight:700; font-size:13px; user-select:none;
    }
    .tool.active{ outline:2px solid var(--accent) }
    .tool.reset{ margin-left:auto; background:#29191b; border-color:#5a2a2e }
    .tool.reset.arm{ outline:2px dashed var(--danger) }

    /* Board nimmt den restlichen Platz ein und ist scrollbar-frei:
       Wir skalieren die Inhalte automatisch, falls H√∂he knapp wird. */
    .board{
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:12px;
  padding:6px;
  display:flex;
  flex-direction:column;
  gap:6px;
  min-height:auto;
  flex:none; /* <-- wichtig */
}

    /* Kompakt-Header je Block */
    .sect-title{
      margin:0; padding:4px 8px; font-size:13px; letter-spacing:.3px; color:var(--text);
      background:#0e1a30; border:1px solid var(--line); border-radius:8px;
    }

    /* Durchgehendes Notizblatt ‚Äì pro Block ein Grid mit 2 Spalten */
    .grid{
      display:grid; grid-template-columns: 1fr 48px; /* Label | K√§stchen */
      border:1px solid var(--line); border-radius:8px; overflow:hidden;
    }
    .cell{
      padding:6px 8px; min-height:28px; display:flex; align-items:center; justify-content:center;
      border-bottom:1px solid var(--line); border-right:1px solid var(--line);
      font-size:14px; cursor:pointer; user-select:none;
    }
    .label{ justify-content:flex-start; color:var(--muted); cursor:default }
    /* letzte in Reihe kein rechter Rand */
    .grid .cell:nth-child(2n){ border-right:none }
    /* letzte Zeile: beide ohne bottom */
    .grid .cell:last-child, .grid .cell:nth-last-child(2){ border-bottom:none }

    /* Markierungen */
    .mark-x{ color:var(--accent); font-weight:900 }
    .mark-q{ color:#ffd36b; font-weight:900 }
    .mark-ok{ color:var(--ok); font-weight:900 }
    .mark-card{ color:var(--card); font-weight:900 }

    footer{ color:var(--muted); font-size:11px }

    /* Falls die Bildschirmh√∂he extrem klein ist, skaliert die Schrift minimal mit runter */
    @media (max-height:700px){
      .cell{ min-height:26px; font-size:13px }
      .tool{ font-size:12px; padding:5px 8px }
      .sect-title{ font-size:12px }
      h1{ font-size:17px }
    }
    @media (max-height:620px){
      .cell{ min-height:24px; font-size:12.5px; padding:5px 7px }
      .grid{ grid-template-columns: 1fr 44px }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ClueNote</h1>
    
    </header>

    <div class="toolbar" id="toolbar">
      <button class="tool active" data-mode="x">‚úï</button>
      <button class="tool" data-mode="q">?</button>
      <button class="tool" data-mode="ok">‚úÖ</button>
      <button class="tool" data-mode="card">üÉè</button>
      <button class="tool" data-mode="clear">‚å´</button>
      <button class="tool reset" id="resetBtn" title="Doppelt dr√ºcken zum Zur√ºcksetzen">Zur√ºcksetzen</button>
    </div>

    <!-- BOARD: alle Kategorien untereinander ‚Äì ohne Scrollen dank kompakter Rows -->
    <div class="board">
      <h3 class="sect-title">WER?</h3>
      <div id="grid-who" class="grid"></div>

      <h3 class="sect-title">WOMIT?</h3>
      <div id="grid-what" class="grid"></div>

      <h3 class="sect-title">WO?</h3>
      <div id="grid-where" class="grid"></div>
    </div>

   
  </div>

  <script>
    // Daten
    const CATEGORIES = [
      { id:'who',   items:['Gr√ºn','Gatow','Porz','Bloom','Gloria','Wei√ü'] },
      { id:'what',  items:['Leuchter','Dolch','Heizungsrohr','Pistole','Seil','Rohrzange'] },
      { id:'where', items:['Musikzimmer','Billardzimmer','Wintergarten','Speisezimmer','Halle','K√ºche','Bibliothek','Salon','Arbeitszimmer'] },
    ];
    const STORAGE_KEY = 'cluenote-compact-v1';

    // State
    const state = {
      mode:'x', // 'x' | 'q' | 'ok' | 'card' | 'clear'
      // marks: {who:[...], what:[...], where:[...]}
      marks: Object.fromEntries(CATEGORIES.map(c => [c.id, c.items.map(()=>'')]))
    };

    // Build all grids
    function buildAll(){
      CATEGORIES.forEach(c => {
        const host = document.getElementById('grid-'+c.id);
        host.innerHTML = '';
        c.items.forEach((label, rIdx) => {
          host.appendChild(cell(label,true));
          const mark = state.marks[c.id][rIdx];
          const box = cell(renderMark(mark),false);
          box.dataset.cat = c.id; box.dataset.r = rIdx;
          box.onclick = onCellClick;
          host.appendChild(box);
        });
      });
    }

    function cell(content, isLabel){
      const d = document.createElement('div');
      d.className = 'cell' + (isLabel ? ' label' : '');
      d.innerHTML = content;
      return d;
    }
    function renderMark(m){
      if(m==='x')   return '<span class="mark-x">√ó</span>';
      if(m==='q')   return '<span class="mark-q">?</span>';
      if(m==='ok')  return '<span class="mark-ok">‚úì</span>';
      if(m==='card')return '<span class="mark-card">üÉè</span>';
      return '';
    }
    function onCellClick(){
      const cat = this.dataset.cat, r = +this.dataset.r;
      state.marks[cat][r] = (state.mode==='clear') ? '' : state.mode;
      this.innerHTML = renderMark(state.marks[cat][r]);
      save();
    }

    // Toolbar & Shortcuts
    const toolbar = document.getElementById('toolbar');
    toolbar.addEventListener('click', e=>{
      const btn = e.target.closest('.tool'); if(!btn) return;
      const m = btn.dataset.mode; if(!m) return;
      state.mode = m; updateActiveTool();
    });
    function updateActiveTool(){
      document.querySelectorAll('.tool').forEach(b=>b.classList.remove('active'));
      const a = document.querySelector(`.tool[data-mode="${state.mode}"]`);
      if(a) a.classList.add('active');
    }
    window.addEventListener('keydown', e=>{
      if(e.key==='1') state.mode='x';
      else if(e.key==='2') state.mode='q';
      else if(e.key==='3') state.mode='clear';
      else if(e.key==='4') state.mode='ok';
      else if(e.key==='5') state.mode='card';
      else return;
      updateActiveTool();
    });

    // Reset (doppelt)
    const resetBtn = document.getElementById('resetBtn');
    let armTimer=null;
    resetBtn.addEventListener('click', ()=>{
      if(!resetBtn.classList.contains('arm')){
        resetBtn.classList.add('arm'); resetBtn.textContent='Nochmal dr√ºcken‚Ä¶';
        clearTimeout(armTimer);
        armTimer = setTimeout(()=>{ resetBtn.classList.remove('arm'); resetBtn.textContent='Zur√ºcksetzen'; }, 2000);
        return;
      }
      clearTimeout(armTimer);
      resetBtn.classList.remove('arm'); resetBtn.textContent='Zur√ºcksetzen';
      Object.keys(state.marks).forEach(k => state.marks[k] = state.marks[k].map(()=>'')); // clear
      save(); buildAll();
    });

    // Persistenz
    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      try{
        const s = JSON.parse(raw);
        if(s && s.marks) state.marks = s.marks;
        if(s && s.mode) state.mode = s.mode;
      }catch(e){ console.warn('Konnte Speicher nicht laden', e); }
    }

    // Start
    load(); buildAll(); updateActiveTool();
  </script>
</body>
</html>
